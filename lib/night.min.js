!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Night",[],e):"object"==typeof exports?exports.Night=e():t.Night=e()}("object"!=typeof window?global.window=global:window,function(){return function(t){var e={};function s(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}return s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var n=i(s(1));e.default=n.default,e.default=n.default,t.exports=e.default},function(t,e,s){"use strict";var i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var s in t)Object.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var n=s(2),o=function(){function t(t){var e=this;this.isPlaying=!1,this.autoCoords=!0,this.autoTimes=!0,this.today=new Date,this.isNight=function(){var t=new Date;return t.getTime()>e.times.sunrise&&t.getTime()<e.times.sunset},this.changeClasses=function(t,s){e.elements instanceof HTMLCollection?Object.values(e.elements).map(function(e){e.classList[t](s)}):e.elements instanceof HTMLElement&&e.elements.classList[t](s)},this.accessSuccess=function(t){var s=t.coords;e.coords={latitude:s.latitude,longitude:s.longitude},"function"==typeof e.callbacks.onAccess&&e.callbacks.onAccess(),e.settings.storage&&localStorage.setItem("location",JSON.stringify(e.coords))},this.accessError=function(t){"function"==typeof e.callbacks.onAccessDenied&&e.callbacks.onAccessDenied(),document.dispatchEvent(new CustomEvent("smartDarkError",{detail:t}))},this.elements=t.elements||document.body,this.settings=this.extendSettings(t.settings||{}),this.callbacks=t.callbacks||{},this.isInit=this.settings.auto,this.init()}return t.prototype.init=function(){"color-scheme"===this.settings.mode?(this.prefersColorScheme(),this.isInit=!1):"smart"===this.settings.mode&&(this.time(new Date),this.smartSwitch(this.isInit)),this.switchOnChange(),"function"==typeof this.callbacks.onInit&&this.callbacks.onInit(),this.settings.brightness&&this.ambientLight()},t.prototype.ambientLight=function(){var t=this;"ondevicelight"in window?(window.addEventListener("devicelight",function(e){e.value<50?(t.changeClasses("add",t.settings.brightnessLowClass),t.changeClasses("remove",t.settings.brightnessHighClass)):(t.changeClasses("add",t.settings.brightnessHighClass),t.changeClasses("remove",t.settings.brightnessLowClass))}),"function"==typeof this.callbacks.onBrightness&&this.callbacks.onBrightness()):"function"==typeof this.callbacks.onBrightnessNotSupported&&(this.callbacks.onBrightnessNotSupported(),this.isNight()?(this.changeClasses("add",this.settings.brightnessLowClass),this.changeClasses("remove",this.settings.brightnessHighClass)):(this.changeClasses("add",this.settings.brightnessHighClass),this.changeClasses("remove",this.settings.brightnessLowClass)))},t.prototype.sound=function(){var t=this;if(!this.isPlaying){var e=new Audio(this.settings.soundUrl);this.isPlaying=!0,e.play(),"function"==typeof this.callbacks.onSoundPlay&&this.callbacks.onSoundPlay(),setTimeout(function(){e.pause(),e.currentTime=0,t.isPlaying=!1,"function"==typeof t.callbacks.onSoundPause&&t.callbacks.onSoundPause()},this.settings.soundTimeout)}},t.prototype.light=function(){"function"==typeof this.callbacks.onLight&&this.callbacks.onLight(),this.isDark=!1,this.settings.lightClass&&this.changeClasses("add",this.settings.lightClass),this.changeClasses("remove",this.settings.darkClass),localStorage.setItem("dark","false")},t.prototype.dark=function(){"function"==typeof this.callbacks.onDark&&this.callbacks.onDark(),this.isDark=!0,this.settings.lightClass&&this.changeClasses("remove",this.settings.lightClass),this.changeClasses("add",this.settings.darkClass),localStorage.setItem("dark","true")},t.prototype.prefersColorScheme=function(){this.matchDark=window.matchMedia("(prefers-color-scheme: dark)").matches,this.matchLight=window.matchMedia("(prefers-color-scheme: light)").matches,this.matchDark||this.matchLight?(this.matchDark?this.dark():this.matchLight&&this.light(),this.isInit&&"function"==typeof this.callbacks.onColorScheme&&this.callbacks.onColorScheme()):this.isInit&&"function"==typeof this.callbacks.onColorSchemeNotSupported&&this.callbacks.onColorSchemeNotSupported()},t.prototype.smartSwitch=function(t){(t&&!localStorage.auto||!t)&&(localStorage.setItem("auto","true"),"function"==typeof this.callbacks.onSmartSwitch&&this.callbacks.onSmartSwitch()),this.settings.sunriseTime&&this.settings.sunsetTime?this.timeBreakpoints():"geolocation"in navigator&&this.isInit&&this.myLocation(),t&&(this.isInit=!1),this.theme(this.isDark)},t.prototype.time=function(t){var e=(new Date).setHours(24,0,0,0);localStorage.time?localStorage.location&&t.getTime()>JSON.parse(localStorage.time)&&(localStorage.removeItem("time"),this.settings.storageClear&&(localStorage.removeItem("location"),"function"==typeof this.callbacks.onStorageClear&&this.callbacks.onStorageClear())):localStorage.setItem("time",JSON.stringify(e))},t.prototype.theme=function(t){t!==this.isDark&&(t?this.dark():this.light())},t.prototype.switchOnChange=function(){var t=this.times,e=t.sunrise,s=t.sunset,i=this.coords,n=i.latitude,o=i.longitude,a={};localStorage.auto&&JSON.parse(localStorage.auto)&&JSON.stringify(a)!==JSON.stringify(this.times)&&(this.isNight()?this.light():this.dark(),a=this.times),document.dispatchEvent(new CustomEvent("smartDark",{detail:{sunrise:new Date(e),sunset:new Date(s),latitude:n,longitude:o}}))},t.prototype.myLocation=function(){var t=this;localStorage.location||!this.autoCoords?(this.autoCoords&&(this.coords=JSON.parse(localStorage.location)),this.autoTimes&&this.sunPosition()):setTimeout(function(){navigator.geolocation.getCurrentPosition(t.accessSuccess,t.accessError)},this.settings.permissionDelay)},t.prototype.sunPosition=function(){var t=this,e=this.coords,n=e.latitude,o=e.longitude;Promise.resolve().then(function(){return i(s(3))}).then(function(e){var s,i,a=e.getTimes(t.today,n,o);s=t.settings.sunriseTime?t.settings.sunriseTime.getTime():a.sunriseEnd-(a.sunriseEnd-a.sunrise)/2,i=t.settings.sunsetTime?t.settings.sunsetTime.getTime():a.sunset-(a.sunset-a.sunsetStart)/2,t.times={sunrise:s,sunset:i}})},t.prototype.timeBreakpoints=function(){this.times={sunrise:this.settings.sunriseTime.getTime(),sunset:this.settings.sunsetTime.getTime()}},t.prototype.setCoords=function(t,e){this.coords={latitude:t,longitude:e},this.autoCoords=!1},t.prototype.setTimes=function(t,e){this.times={sunrise:t,sunset:e},this.autoTimes=!1},t.prototype.toggle=function(){"function"==typeof this.callbacks.onToggle&&this.callbacks.onToggle(),this.settings.soundUrl&&this.sound(),this.theme(!this.isDark),localStorage.setItem("auto","false")},t.prototype.reset=function(){localStorage.clear(),"function"==typeof this.callbacks.onReset&&this.callbacks.onReset()},t.prototype.destroy=function(){"function"==typeof this.callbacks.onDestroy&&this.callbacks.onDestroy()},t.prototype.extendSettings=function(t){var e,s={};for(e in n.defaultSettings)s[e]=e in t?t[e]:n.defaultSettings[e];return s},t}();e.default=o},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.defaultSettings={auto:!0,brightness:!1,brightnessHighClass:"high-brightness",brightnessLowClass:"low-brightness",checkBreakpoint:!0,darkClass:"dark",lightClass:"",mode:"smart",permissionDelay:0,soundTimeout:1e3,soundUrl:"",storage:!0,storageClear:!0,sunriseTime:null,sunsetTime:null}},function(t,e,s){!function(){"use strict";var e=Math.PI,s=Math.sin,i=Math.cos,n=Math.tan,o=Math.asin,a=Math.atan2,r=Math.acos,c=e/180,u=864e5,l=2440588,h=2451545;function g(t){return new Date((t+.5-l)*u)}function d(t){return function(t){return t.valueOf()/u-.5+l}(t)-h}var f=23.4397*c;function m(t,e){return a(s(t)*i(f)-n(e)*s(f),i(t))}function p(t,e){return o(s(e)*i(f)+i(e)*s(f)*s(t))}function y(t,e,o){return a(s(t),i(t)*s(e)-n(o)*i(e))}function b(t,e,n){return o(s(e)*s(n)+i(e)*i(n)*i(t))}function v(t,e){return c*(280.16+360.9856235*t)-e}function k(t){return c*(357.5291+.98560028*t)}function S(t){return t+c*(1.9148*s(t)+.02*s(2*t)+3e-4*s(3*t))+102.9372*c+e}function C(t){var e=S(k(t));return{dec:p(e,0),ra:m(e,0)}}var w={getPosition:function(t,e,s){var i=c*-s,n=c*e,o=d(t),a=C(o),r=v(o,i)-a.ra;return{azimuth:y(r,n,a.dec),altitude:b(r,n,a.dec)}}},T=w.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];w.addTime=function(t,e,s){T.push([t,e,s])};var M=9e-4;function D(t,s,i){return M+(t+s)/(2*e)+i}function P(t,e,i){return h+t+.0053*s(e)-.0069*s(2*i)}function O(t,e,n,o,a,c,u){return P(D(function(t,e,n){return r((s(t)-s(e)*s(n))/(i(e)*i(n)))}(t,n,o),e,a),c,u)}function I(t){var e=c*(134.963+13.064993*t),n=c*(93.272+13.22935*t),o=c*(218.316+13.176396*t)+6.289*c*s(e),a=5.128*c*s(n),r=385001-20905*i(e);return{ra:m(o,a),dec:p(o,a),dist:r}}function _(t,e){return new Date(t.valueOf()+e*u/24)}w.getTimes=function(t,s,i){var n,o,a,r,u,l=c*-i,h=c*s,f=function(t,s){return Math.round(t-M-s/(2*e))}(d(t),l),m=D(0,l,f),y=k(m),b=S(y),v=p(b,0),C=P(m,y,b),w={solarNoon:g(C),nadir:g(C+.5)};for(n=0,o=T.length;n<o;n+=1)u=C-((r=O((a=T[n])[0]*c,l,h,v,f,y,b))-C),w[a[1]]=g(u),w[a[2]]=g(r);return w},w.getMoonPosition=function(t,e,o){var r=c*-o,u=c*e,l=d(t),h=I(l),g=v(l,r)-h.ra,f=b(g,u,h.dec),m=a(s(g),n(u)*i(h.dec)-s(h.dec)*i(g));return f+=function(t){return t<0&&(t=0),2967e-7/Math.tan(t+.00312536/(t+.08901179))}(f),{azimuth:y(g,u,h.dec),altitude:f,distance:h.dist,parallacticAngle:m}},w.getMoonIllumination=function(t){var e=d(t||new Date),n=C(e),o=I(e),c=r(s(n.dec)*s(o.dec)+i(n.dec)*i(o.dec)*i(n.ra-o.ra)),u=a(149598e3*s(c),o.dist-149598e3*i(c)),l=a(i(n.dec)*s(n.ra-o.ra),s(n.dec)*i(o.dec)-i(n.dec)*s(o.dec)*i(n.ra-o.ra));return{fraction:(1+i(u))/2,phase:.5+.5*u*(l<0?-1:1)/Math.PI,angle:l}},w.getMoonTimes=function(t,e,s,i){var n=new Date(t);i?n.setUTCHours(0,0,0,0):n.setHours(0,0,0,0);for(var o,a,r,u,l,h,g,d,f,m,p,y,b,v=.133*c,k=w.getMoonPosition(n,e,s).altitude-v,S=1;S<=24&&(o=w.getMoonPosition(_(n,S),e,s).altitude-v,d=((l=(k+(a=w.getMoonPosition(_(n,S+1),e,s).altitude-v))/2-o)*(g=-(h=(a-k)/2)/(2*l))+h)*g+o,m=0,(f=h*h-4*l*o)>=0&&(p=g-(b=Math.sqrt(f)/(2*Math.abs(l))),y=g+b,Math.abs(p)<=1&&m++,Math.abs(y)<=1&&m++,p<-1&&(p=y)),1===m?k<0?r=S+p:u=S+p:2===m&&(r=S+(d<0?y:p),u=S+(d<0?p:y)),!r||!u);S+=2)k=a;var C={};return r&&(C.rise=_(n,r)),u&&(C.set=_(n,u)),r||u||(C[d>0?"alwaysUp":"alwaysDown"]=!0),C},t.exports=w}()}])});